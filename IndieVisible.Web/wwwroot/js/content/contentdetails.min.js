var CONTENTACTIONS=function(){"use strict";function e(){o();s();h()}function o(){n.container=".content-wrapper";n.item=".box-content";n.btnShare=".btn-share";n.sharePopup=".share-popup";n.btnInteractionComment=".btn-interaction-comment";n.commentBox=".interaction-commentbox";n.commentTextArea=".commenttextarea";n.btnLike=".btn-interaction-like";n.btnInteractionShare=".btn-interaction-share";n.sharePopup=".share-popup";n.likeCounter=".like-count"}function s(){t.container=$(n.container)}function h(){c();l();a();v();y();i()}function c(){t.container.on("click",n.btnLike,function(){var t=$(this),i=t.closest(n.item).find(n.likeCounter),r=t.data("id");t.hasClass("like-liked")?b(r).done(function(n){k(n,i,t)}):p(r).done(function(n){w(n,i,t)})})}function l(){t.container.on("click",n.btnInteractionComment,function(){var t=$(this),i=t.closest(n.item).find(".box-commentsection"),r=t.closest(n.item).find(n.commentBox),u=t.closest(n.item).find(n.commentTextArea);i.is(":visible")?(i.addClass("d-none"),r.addClass("d-none")):(i.removeClass("d-none"),r.removeClass("d-none"),u.val("").focus())})}function a(){t.container.on("keyup","textarea.commentbox",function(t){var e=$(this);if((t.keyCode===10||t.keyCode===13)&&t.ctrlKey){var i=e.closest(n.commentBox).find(".commenttextarea"),s=i.data("url"),h=e.closest(n.item).find(".comment-count"),c=i.data("usercontentid"),o=i.val().replace(/\n/g,"<br>\n"),l=i.data("usercontenttype");o.length>0&&r(s,c,o,l).done(function(n){u(n,h,i)})}f(this)})}function v(){t.container.on("click",".btn-interaction-comment-send",function(){var f=$(this),t=f.closest(n.commentBox).find(".commenttextarea"),e=t.data("url"),o=t.closest(n.item),s=o.find(".comment-count"),h=t.data("usercontentid"),i=t.val().replace(/\n/g,"<br>\n"),c=t.data("usercontenttype");i.length>0&&r(e,h,i,c).done(function(n){u(n,s,t)})})}function y(){t.container.on("click",n.btnShare,function(t){var u;t.preventDefault();$(n.sharePopup).fadeOut();var i=$(this).prop("href"),f=$(this).data("title"),r=$(this).data("provider");return i=encodeURI(i),r==="facebook"?FB.ui({method:"share",href:i},function(){}):r==="reddit"?(i="https://www.reddit.com/submit?title="+f+"&url="+i,window.open(i)):r==="twitter"?(u=$(this).data("text"),i="https://www.twitter.com/intent/tweet?text="+u+" "+i,window.open(i)):console.log(r),!1})}function i(){$(n.btnInteractionShare).each(function(t,i){var r=$(i),u=r.data();if(console.log(t),u.target){$(r).off("click");$(r).on("click",function(){console.log("clickshare");var t=$(u.target),i=r.position();t.css("top",i.top-80);t.on("mouseleave",function(){setTimeout(function(){t.is(":visible")&&t.fadeOut()},500)});$(n.sharePopup).fadeOut();t.is(":visible")?t.fadeOut():t.fadeIn()})}})}function p(n){return $.post("/content/like",{targetId:n})}function w(n,t,i){n.success===!0&&($(t).text(n.value),i.addClass("text-blue"),i.addClass("like-liked"))}function b(n){return $.post("/content/unlike",{targetId:n})}function k(n,t,i){n.success===!0&&($(t).text(n.value),i.removeClass("text-blue"),i.removeClass("like-liked"))}function r(n,t,i,r){return(n===null||n===undefined||n.length===0)&&(n="/content/comment"),$.post(n,{UserContentId:t,Text:i,UserContentType:r})}function u(t,i,r){var f,e,u,o,s;t.success===!0&&(f=r.closest(n.commentBox),e=r.val().replace(/\n/g,"<br>\n"),r.val(""),$(i).text(t.value),CONTENTACTIONS.AutosizeTextArea(r[0]),u=$(".box-comment-template").first().clone(),o=f.find("img").attr("src"),u.find("img").attr("src",o),u.find(".comment-authorname").text(f.data("fullname")),u.find(".comment-content").html(e),s=r.closest(".box-comments").find(".box-commentsection"),s.append(u.removeClass("d-none")))}function f(n){setTimeout(function(){n.style.cssText="height:auto;";n.style.cssText="height:"+(n.scrollHeight+2)+"px"},0)}var n={},t={};return{Init:e,AutosizeTextArea:f,BindShareContent:i}}(),CONTENTDETAILS,POLLS;$(function(){CONTENTACTIONS.Init()});CONTENTDETAILS=function(){"use strict";function n(){t();i()}function t(){}function i(){}return{Init:n}}();$(function(){CONTENTDETAILS.Init()});POLLS=function(){"use strict";function t(){i();r()}function i(){n.divPostPoll=$("div#divPostPoll");n.options=$("input.polloptioninput")}function r(){u();f();e()}function u(){$(".content").on("click","#btnAddOption",function(){var u=n.divPostPoll.children(".polloption:first"),t=u.clone(),i=t.children(".polloptioninput"),r;i.val("");r=t.find(".btn-option-remove");$(r).removeClass("invisible");t.insertBefore("#btnAddOption");t.addClass("polloptionextra");i.focus();POLLS.Events.PostAddOption()})}function f(){$(".content").on("click",".btn-option-remove",function(){var n=$(this).closest(".polloption");n.remove();POLLS.Events.PostAddOption()})}function e(){$(".content").on("click","ul.poll.canvote li input.poll-option",function(){var n=$(this);s(n.val()).done(function(t){h(t,n)})})}function o(){n.options.val("");$(".polloptionextra").remove()}function s(n){return $.post("/interact/poll/vote",{pollOptionId:n}).done(function(n){n.success&&MAINMODULE.Common.HandlePointsEarned(n)})}function h(n,t){var u,e,i;if(n.success===!0){var r=t.closest("ul.poll"),s=r.closest(".poll-wrapper"),h=s.find(".poll-vote-count"),c=r.children("li");for($(c).each(function(){var n=$(this);n.removeClass("voted").addClass("notvoted");var t=n.children("span.perc-back"),i=n.children("span.perc-number"),r=n.find("input");t.css("width","0");i.text("0.00%");r.prop("checked",!1)}),u=$(t).parent("li"),u.removeClass("notvoted").addClass("voted"),e=u.find("input"),e.prop("checked",!0),i=0;i<n.value.optionResults.length;i++){var f=n.value.optionResults[i],l=r.find(`input[value="${f.optionId}"]`),o=l.parent("li"),a=o.children("span.perc-back"),v=o.children("span.perc-number");a.css("width",f.percentage+"%");v.text(f.percentage+"%")}h.text(n.value.totalVotes)}}var n={};return{Init:t,Methods:{ClearOptions:o},Events:{PostAddOption:function(){}}}}();$(function(){POLLS.Init()});