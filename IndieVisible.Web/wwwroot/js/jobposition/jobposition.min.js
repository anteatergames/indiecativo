var JOBPOSITION=function(){"use strict";function w(){if(b(),a(),d(),i=t.container.find(n.canInteract).val(),l=t.container.find(n.jobProfile).val()==="Company",c=window.location.href.indexOf("add")>-1,o=window.location.href.indexOf("details")>-1,h=!c&&!o,h)if(l){var u=t.urls.data("urlMine");r(!1,u);s(e)}else r(!1,f),ct(p);else o&&g()}function b(){n.controlsidebar=".control-sidebar";n.canInteract="#caninteract";n.urls="#urls";n.jobProfile="#jobprofile";n.container="#jobpositioncontainer";n.containerDetails="#containerdetails";n.containerList="#containerlist";n.list="#divList";n.divListItem=".jobposition-item";n.btnNewJobPosition="#btn-jobposition-new";n.btnNewExternalJobPosition="#btn-jobposition-new-external";n.btnListMine="#btn-jobposition-listmine";n.form="#frmJobPositionSave";n.btnSave="#btnPostJobPosition";n.btnEditJobPosition=".btnEditJobPosition";n.btnDeleteJobPosition=".btnDeleteJobPosition";n.btnApply="#btnApply";n.chkRemote="#Remote";n.location="#Location";n.origin="#Origin";n.url="#Url";n.myPositionStats="#divMyPositionStats";n.myApplications="#divMyApplications";n.datepicker=".datepicker";n.switchBenefit=".switch-benefit";n.hdnBenefit=".hdnBenefit";n.applicantRating=".applicant-rating";n.btnShare=".btn-share"}function a(){t.controlsidebar=$(n.controlsidebar);t.container=$(n.container);t.urls=$(n.urls);t.containerDetails=$(n.containerDetails);t.containerList=$(n.containerList);t.list=$(n.list);t.myPositionStats=$(n.myPositionStats);t.myApplications=$(n.myApplications);t.btnApply=$(n.btnApply)}function k(){t.location=$(n.location);t.origin=$(n.origin);t.url=$(n.url)}function v(){k();$(n.datepicker).datepicker()}function d(){it();rt();ut();ht();ft();et();ot();st()}function g(){tt();nt()}function nt(){t.container.on("click",n.btnShare,function(n){var r;n.preventDefault();var t=$(this).prop("href"),u=$(this).data("title"),i=$(this).data("provider");return t=encodeURI(t),i==="facebook"?FB.ui({method:"share",href:t},function(){}):i==="reddit"?(t="https://www.reddit.com/submit?title="+u+"&url="+t,window.open(t)):i==="twitter"?(r=$(this).data("text"),t="https://www.twitter.com/intent/tweet?text="+r+" "+t,window.open(t)):console.log(i),!1})}function tt(){$(n.applicantRating).rating({theme:"krajee-fas",showClear:!1,size:"md",animate:!1,step:.5,filledStar:'<i class="fas fa-gamepad tilt-20"><\/i>',emptyStar:'<i class="fas fa-gamepad tilt-20"><\/i>',starCaptions:{.5:"Padawan",1:"1",1.5:"1.5",2:"2",2.5:"2.5",3:"3",3.5:"3.5",4:"4",4.5:"4.5",5:"Jedi"}});t.container.on("rating:change",n.applicantRating,function(n,t){var r=$(this).data("url"),i;console.log(t);i={score:t};yt(r,i)})}function it(){t.container.on("click",n.btnNewExternalJobPosition,function(){var n=$(this).data("url");i&&y(n)})}function rt(){t.container.on("click",n.btnNewJobPosition,function(){var n=$(this).data("url");i&&y(n)})}function ut(){t.containerDetails.on("click",n.btnSave,function(){var r=$(this),n,u;r.html(MAINMODULE.Default.SpinnerBtn);n=t.form.valid();u=t.origin.val();u==="external"&&t.url.val().length===0&&(n=!1,ALERTSYSTEM.ShowWarningMessage(MAINMODULE.Common.TranslatedMessages.msgUrlMissing));n&&i&&vt(r)})}function ft(){t.container.on("click",n.btnEditJobPosition,function(n){n.preventDefault();var t=$(this).data("url");i&&at(t)})}function et(){t.container.on("click",n.btnDeleteJobPosition,function(t){t.preventDefault();var i=$(this),u=$(this).data("url"),o=i.data("confirmationmessage"),h=i.data("confirmationtitle"),c=i.data("confirmationbuttontext"),l=i.data("cancelbuttontext");ALERTSYSTEM.ShowConfirmMessage(h,o,c,l,function(){$.ajax({url:u,type:"DELETE"}).done(function(t){t.success?(i.closest(n.divListItem).remove(),t.message?ALERTSYSTEM.ShowSuccessMessage(t.message,function(){t.url?window.location=t.url:(r(!1,f),s(e))}):t.url?window.location=t.url:(r(!1,f),s(e))):ALERTSYSTEM.ShowWarningMessage(t.message)})})})}function ot(){t.containerDetails.on("change",n.chkRemote,function(){var n=$(this).is(":checked");n?t.location.val("").hide():t.location.val("").show()})}function st(){t.containerDetails.on("change",n.switchBenefit,function(){var t=$(this),r=t.is(":checked"),i=t.parent().find(n.hdnBenefit);r?i.val("True"):i.val("False")})}function ht(){t.container.on("click",n.btnApply,function(n){var t,r,u;return console.log("meh"),n.preventDefault(),t=$(this),r=t.html(),t.html(MAINMODULE.Default.SpinnerBtn),u=t.data("url"),i&&lt(u,function(n){n.success===!0?t.html("..."):t.html(r);console.log(n)}),!1})}function r(n,i){t.list.html(MAINMODULE.Default.Spinner);t.containerDetails.html("");t.containerDetails.hide();$.get(i,function(i){n?(t.list.html(i),t.containerList.show(),a()):t.list.html(i)})}function s(n){t.myPositionStats.html(MAINMODULE.Default.SpinnerTop);$.get(n,function(n){t.myPositionStats.html(n)})}function ct(n){t.myApplications.html(MAINMODULE.Default.SpinnerTop);$.get(n,function(n){t.myApplications.html(n)})}function y(i){t.containerDetails.html(MAINMODULE.Default.Spinner);t.containerList.hide();$.get(i,function(i){t.containerDetails.html(i);t.containerDetails.show();t.form=$(n.form);$.validator.unobtrusive.parse(n.form);v()})}function lt(n,t){$.post(n).done(function(n){n.success===!0?(t&&t(n),ALERTSYSTEM.ShowSuccessMessage(n.message,function(){n.url&&(window.location=n.url)})):ALERTSYSTEM.ShowWarningMessage(n.message)})}function at(i){t.containerDetails.html(MAINMODULE.Default.Spinner);t.containerList.hide();$.get(i,function(i){t.containerDetails.html(i);t.containerDetails.show();t.form=$(n.form);$.validator.unobtrusive.parse(t.form);v()})}function vt(n,i){var r=t.form.attr("action"),u=t.form.serialize();$.post(r,u).done(function(t){t.success===!0?(n.html("..."),i&&i(),ALERTSYSTEM.ShowSuccessMessage("Awesome!",function(){window.location=t.url})):ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})}function yt(n,t,i){$.post(n,t).done(function(n){n.success===!0?(i&&i(n),ALERTSYSTEM.ShowSuccessMessage(n.message,function(){n.url&&(window.location=n.url)})):ALERTSYSTEM.ShowWarningMessage(n.message)})}var u="/work/jobposition",f=u+"/list",e=u+"/mypositionsstats",p=u+"/myapplications",n={},t={},i=!1,h=!1,c=!1,o=!1,l=!1;return{Init:w}}(),CONTENTACTIONS;$(function(){JOBPOSITION.Init()});CONTENTACTIONS=function(){"use strict";function f(){e();o();s()}function e(){n.container=".content";n.btnShare=".btn-share";n.sharePopup=".share-popup";n.btnInteractionComment=".btn-interaction-comment";n.commentBox=".interaction-commentbox";n.commentTextArea=".commenttextarea"}function o(){t.container=$(n.container)}function s(){h();c();l();a();v()}function h(){t.container.on("click",".btn-interaction-like",function(){var n=$(this),t=n.closest(".box-content").find(".like-count"),i=n.data("id");n.hasClass("like-liked")?w(i).done(function(i){b(i,t,n)}):y(i).done(function(i){p(i,t,n)})})}function c(){$(".content").on("click",n.btnInteractionComment,function(){var t=$(this),i=t.closest(".box-content").find(".box-commentsection"),r=t.closest(".box-content").find(n.commentBox),u=t.closest(".box-content").find(n.commentTextArea);i.is(":visible")?(i.addClass("d-none"),r.addClass("d-none")):(i.removeClass("d-none"),r.removeClass("d-none"),u.val("").focus())})}function l(){$(".content").on("keyup","textarea.commentbox",function(n){var f=$(this);if((n.keyCode===10||n.keyCode===13)&&n.ctrlKey){var t=f.closest(".interaction-commentbox").find(".commenttextarea"),o=t.data("url"),s=f.closest(".box-content").find(".comment-count"),h=t.data("usercontentid"),e=t.val().replace(/\n/g,"<br>\n"),c=t.data("usercontenttype");e.length>0&&i(o,h,e,c).done(function(n){r(n,s,t)})}u(this)})}function a(){$(".content").on("click",".btn-interaction-comment-send",function(){var u=$(this),n=u.closest(".interaction-commentbox").find(".commenttextarea"),f=n.data("url"),e=n.closest(".box-content"),o=e.find(".comment-count"),s=n.data("usercontentid"),t=n.val().replace(/\n/g,"<br>\n"),h=n.data("usercontenttype");t.length>0&&i(f,s,t,h).done(function(t){r(t,o,n)})})}function v(){t.container.on("click",n.btnShare,function(t){var u;t.preventDefault();$(n.sharePopup).fadeOut();var i=$(this).prop("href"),f=$(this).data("title"),r=$(this).data("provider");return i=encodeURI(i),r==="facebook"?FB.ui({method:"share",href:i},function(){}):r==="reddit"?(i="https://www.reddit.com/submit?title="+f+"&url="+i,window.open(i)):r==="twitter"?(u=$(this).data("text"),i="https://www.twitter.com/intent/tweet?text="+u+" "+i,window.open(i)):console.log(r),!1})}function y(n){return $.post("/content/like",{targetId:n})}function p(n,t,i){n.success===!0&&($(t).text(n.value),i.addClass("text-blue"),i.addClass("like-liked"))}function w(n){return $.post("/content/unlike",{targetId:n})}function b(n,t,i){n.success===!0&&($(t).text(n.value),i.removeClass("text-blue"),i.removeClass("like-liked"))}function i(n,t,i,r){return(n===null||n===undefined||n.length===0)&&(n="/content/comment"),$.post(n,{UserContentId:t,Text:i,UserContentType:r})}function r(t,i,r){var o,u,s,e,f;t.success===!0&&(f=r.closest(".interaction-commentbox"),o=r.val().replace(/\n/g,"<br>\n"),r.val(""),$(i).text(t.value),CONTENTACTIONS.AutosizeTextArea(r[0]),u=$(".box-comment-template").first().clone(),s=f.find("img").attr("src"),u.find("img").attr("src",s),u.find(".comment-authorname").text(f.data("fullname")),u.find(".comment-content").html(o),e=r.closest(".box-comments").find(".box-commentsection"),e.append(u.removeClass("d-none")),f=r.closest(".box-comments").find(n.commentBox),e.append(u.removeClass("d-none")))}function u(n){setTimeout(function(){n.style.cssText="height:auto;";n.style.cssText="height:"+(n.scrollHeight+2)+"px"},0)}var n={},t={};return{Init:f,AutosizeTextArea:u}}();$(function(){CONTENTACTIONS.Init()});