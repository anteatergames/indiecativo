var BRAINSTORM=function(){"use strict";function o(){s();h();c();i=t.container.find("#caninteract").val();u=window.location.href.indexOf("newidea")>-1;f=window.location.href.indexOf("details")>-1;u||f||b();t.ddlStatus.removeClass("invisible").show()}function s(){n.container=".content";n.toolbar=$("#divToolbar");n.list=$("#divList");n.btnPostVotingItem=$("#btnPostVotingItem");n.btnPostBrainstormIdea="#btnPostBrainstormIdea";n.form=$("#frmBrainstormIdeaSave");n.ddlStatus="#ddlStatus"}function h(){t.container=$(n.container);t.ddlStatus=$(n.ddlStatus);t.btnPostBrainstormIdea=$(n.btnPostBrainstormIdea)}function c(){a();v();y();p();w();l()}function l(){t.container.on("change",n.ddlStatus,function(){var n=$(this).val(),t=$(this).data("url"),i=$(this).data("id"),r={selectedStatus:n,ideaId:i};$.post(t,r).done(function(n){n.success===!0?ALERTSYSTEM.ShowSuccessMessage("Awesome!",function(){window.location=n.url}):ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})})}function a(){t.container.on("click",".btn-idea-new",function(){i&&k()})}function v(){t.container.on("click",".btn-session-new",function(){i&&d()})}function y(){t.container.on("click",n.btnPostBrainstormIdea,function(t){var r,u,f,o;return t.preventDefault(),r=$(this),u=n.form.valid(),u&&i&&(r.prop("disabled",!0),f=r.html(),r.html(MAINMODULE.Default.SpinnerBtn),o=function(){r.html(f);r.prop("disabled",!1)},e(o)),!1})}function p(){t.container.on("click","#btnPostBrainstormSession",function(t){var r,u,f,o;return t.preventDefault(),r=$(this),u=n.form.valid(),u&&i&&(r.prop("disabled",!0),f=r.html(),r.html(MAINMODULE.Default.SpinnerBtn),o=function(){r.html(f);r.prop("disabled",!1)},e(o)),!1})}function w(){t.container.on("click",".brainstorm-button",function(){var n=$(this),t=n.closest(".brainstorm-item"),e=t.data("id"),u=n.data("vote"),o=t.data("currentuservote")===u,f;if(i==="true"&&!o)return f=r+"/vote",$.post(f,{votingItemId:e,voteValue:u}).then(function(n){n.success===!0?ALERTSYSTEM.ShowSuccessMessage("Awesome!",function(){location.reload()}):ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})})}function b(){n.list.html(MAINMODULE.Default.Spinner);var t="/list",i=$("#Id").val();i&&(t+="/"+i);$.get(r+t,function(t){n.list.html(t)})}function k(){var i=$("#brainstormcontainer #Id").val();t.container.html(MAINMODULE.Default.Spinner);$.get(r+"/"+i+"/newidea",function(i){t.container.html(i);n.form=$("#frmBrainstormIdeaSave");$.validator.unobtrusive.parse(n.form)})}function d(){t.container.html(MAINMODULE.Default.Spinner);$.get(r+"/newsession",function(i){t.container.html(i);n.form=$("#frmBrainstormSessionSave");$.validator.unobtrusive.parse(n.form)})}function e(t){var i=n.form.attr("action"),r=n.form.serialize();$.post(i,r).done(function(n){n.success===!0?(t&&t(),ALERTSYSTEM.ShowSuccessMessage("Awesome!",function(){window.location=n.url})):ALERTSYSTEM.ShowWarningMessage("An error occurred! Check the console!")})}var r="/brainstorm",n={},t={},i=!1,u=!1,f=!1;return{Init:o}}(),CONTENTACTIONS;$(function(){BRAINSTORM.Init()});CONTENTACTIONS=function(){"use strict";function f(){e();o();s()}function e(){n.container="body";n.btnShare=".btn-share"}function o(){t.container=$(n.container);console.log(t.container)}function s(){h();c();l();a();v()}function h(){$(".content").on("click",".btn-interaction-like",function(){var n=$(this),t=n.closest(".box-content").find(".like-count"),i=n.data("id");n.hasClass("like-liked")?w(i).done(function(i){b(i,t,n)}):y(i).done(function(i){p(i,t,n)})})}function c(){$(".content").on("click",".btn-interaction-comment",function(){$(this).closest(".box-content").find("textarea.commentbox").val("").focus()})}function l(){$(".content").on("keyup","textarea.commentbox",function(n){var f=$(this);if((n.keyCode===10||n.keyCode===13)&&n.ctrlKey){var t=f.closest(".interaction-commentbox").find(".commenttextarea"),o=t.data("url"),s=f.closest(".box-content").find(".comment-count"),h=t.data("usercontentid"),e=t.val().replace(/\n/g,"<br>\n"),c=t.data("usercontenttype");e.length>0&&i(o,h,e,c).done(function(n){r(n,s,t)})}u(this)})}function a(){$(".content").on("click",".btn-interaction-comment-send",function(){var u=$(this),n=u.closest(".interaction-commentbox").find(".commenttextarea"),f=n.data("url"),e=n.closest(".box-content"),o=e.find(".comment-count"),s=n.data("usercontentid"),t=n.val().replace(/\n/g,"<br>\n"),h=n.data("usercontenttype");t.length>0&&i(f,s,t,h).done(function(t){r(t,o,n)})})}function v(){console.log("bindShare");t.container.on("click",n.btnShare,function(n){var r;n.preventDefault();console.log($(this));var t=$(this).prop("href"),u=$(this).data("title"),i=$(this).data("provider");return t=encodeURI(t),i==="facebook"?FB.ui({method:"share",href:t},function(){}):i==="reddit"?(t="https://www.reddit.com/submit?title="+u+"&url="+t,window.open(t)):i==="twitter"?(r=$(this).data("text"),t="https://www.twitter.com/intent/tweet?text="+r+" "+t,window.open(t)):console.log(i),!1})}function y(n){return $.post("/content/like",{targetId:n})}function p(n,t,i){n.success===!0&&($(t).text(n.value),i.addClass("text-blue"),i.addClass("like-liked"))}function w(n){return $.post("/content/unlike",{targetId:n})}function b(n,t,i){n.success===!0&&($(t).text(n.value),i.removeClass("text-blue"),i.removeClass("like-liked"))}function i(n,t,i,r){return(n===null||n===undefined||n.length===0)&&(n="/content/comment"),$.post(n,{UserContentId:t,Text:i,UserContentType:r})}function r(n,t,i){var u,f,r,e,o;n.success===!0&&(u=i.closest(".interaction-commentbox"),f=i.val().replace(/\n/g,"<br>\n"),i.val(""),$(t).text(n.value),CONTENTACTIONS.AutosizeTextArea(i[0]),r=$(".box-comment-template").first().clone(),e=u.find("img").attr("src"),r.find("img").attr("src",e),r.find(".comment-authorname").text(u.data("fullname")),r.find(".comment-content").html(f),o=i.closest(".box-comments").find(".box-commentsection"),o.append(r.removeClass("d-none")))}function u(n){setTimeout(function(){n.style.cssText="height:auto;";n.style.cssText="height:"+(n.scrollHeight+2)+"px"},0)}var n={},t={};return{Init:f,AutosizeTextArea:u}}();$(function(){CONTENTACTIONS.Init()});